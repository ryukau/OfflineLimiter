// Copyright (C) 2022  Takamitsu Endo
//
// This program is free software; you can redistribute it and/or
// modify it under the terms of the GNU General Public License
// as published by the Free Software Foundation; either version 2
// of the License, or (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with this program; if not, write to the Free Software
// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.

#pragma once

#include <array>

/**
FIR polyphase lowpass coefficients for 8 fold upsampling.

```python
import numpy as np
import scipy.signal as signal
nTaps = 64
nPhase = 8
fir = signal.firwin(nTaps * nPhase - 1, 24000, window=("dpss", 4), fs=8 * 48000)
fir = np.hstack((fir, [0]))
poly = fir.reshape((nTaps, nPhase)).T
for i, p in enumerate(poly):
    poly[i] = p[::-1]
```
*/
template<typename Sample> struct DownSamplerCoefficient {
  constexpr static size_t bufferSize = 64;
  constexpr static size_t intDelay = 31;
  constexpr static size_t upfold = 8;

  constexpr static std::array<std::array<Sample, bufferSize>, upfold> coefficient{{
    {
      Sample(-8.173548204222876e-08),  Sample(2.51482491385813e-07),
      Sample(-6.021079666981917e-07),  Sample(1.253769860681655e-06),
      Sample(-2.378271451902631e-06),  Sample(4.212199706240283e-06),
      Sample(-7.071094163221226e-06),  Sample(1.1364261063853213e-05),
      Sample(-1.7609823541460758e-05), Sample(2.6449644680517934e-05),
      Sample(-3.8663903164240436e-05), Sample(5.5185374037274136e-05),
      Sample(-7.711391285422158e-05),  Sample(0.00010573232152611557),
      Sample(-0.00014252578365348055), Sample(0.0001892085537900808),
      Sample(-0.0002477638434775698),  Sample(0.0003205063627193064),
      Sample(-0.00041018267295635295), Sample(0.0005201341677961046),
      Sample(-0.0006545646869902244),  Sample(0.0008189869558993364),
      Sample(-0.0010209857280302525),  Sample(0.0012715695620547968),
      Sample(-0.0015876864908528467),  Sample(0.001997227980889961),
      Sample(-0.0025499106324606865),  Sample(0.0033439963668826186),
      Sample(-0.004604309625872099),   Sample(0.006980500436274886),
      Sample(-0.013435919042998344),   Sample(0.1218009319778185),
      Sample(0.017324805014899674),    Sample(-0.007957208488866859),
      Sample(0.005048475706348483),    Sample(-0.003601466552078123),
      Sample(0.002720181184159224),    Sample(-0.0021192896052797186),
      Sample(0.0016798675299234784),   Sample(-0.001343607005738116),
      Sample(0.0010785428170204795),   Sample(-0.0008656062410044361),
      Sample(0.0006926053620364718),   Sample(-0.0005512583640555302),
      Sample(0.0004356229169704949),   Sample(-0.00034121913980099345),
      Sample(0.00026452049401384055),  Sample(-0.00020265018158961744),
      Sample(0.00015319686250918338),  Sample(-0.0001141014755413125),
      Sample(8.358695544657091e-05),   Sample(-6.01137454155908e-05),
      Sample(4.235047647477649e-05),   Sample(-2.915313648826137e-05),
      Sample(1.9548565602320628e-05),  Sample(-1.2719770012619276e-05),
      Sample(7.991659049318681e-06),   Sample(-4.816562242315332e-06),
      Sample(2.75938061473012e-06),    Sample(-1.4825379236355748e-06),
      Sample(7.310695658782081e-07),   Sample(-3.18254362438016e-07),
      Sample(1.1218570885256981e-07),  Sample(-2.361760933753526e-08),
    },
    {
      Sample(-1.272635019127103e-07),  Sample(4.1086275742419263e-07),
      Sample(-1.006523233947465e-06),  Sample(2.125927687829756e-06),
      Sample(-4.073317099387585e-06),  Sample(7.269484947813396e-06),
      Sample(-1.2277756803317764e-05), Sample(1.983125573093447e-05),
      Sample(-3.086069683731601e-05),  Sample(4.6522020557252406e-05),
      Sample(-6.822341290805418e-05),  Sample(9.765173115755978e-05),
      Sample(-0.0001367991317339614),  Sample(0.0001879918916897651),
      Sample(-0.0002539251913544879),  Sample(0.0003377102567748335),
      Sample(-0.00044294421849006346), Sample(0.0005738191773247182),
      Sample(-0.0007352968550954017),  Sample(0.0009333918745799367),
      Sample(-0.0011756361867928094),  Sample(0.0014718519921115495),
      Sample(-0.0018354682086414785),  Sample(0.002285840401696952),
      Sample(-0.002852537945309115),   Sample(0.0035837917574947525),
      Sample(-0.0045646339365266264),  Sample(0.005960668445510357),
      Sample(-0.008142643464987031),   Sample(0.0121431567635689),
      Sample(-0.022305349892644943),   Sample(0.11249888367650271),
      Sample(0.03739132540326195),     Sample(-0.015794621168051855),
      Sample(0.009792270631077106),    Sample(-0.006914734981821751),
      Sample(0.0051949238194164025),   Sample(-0.004035377644430188),
      Sample(0.003193466271687802),    Sample(-0.002552215360482148),
      Sample(0.002048271684963399),    Sample(-0.0016442014312371854),
      Sample(0.0013162635753481778),   Sample(-0.0010484471418521827),
      Sample(0.0008293391455525527),   Sample(-0.0006503857644184292),
      Sample(0.0005048871567487854),   Sample(-0.00038739970795351213),
      Sample(0.0002933738565599654),   Sample(-0.00021893194903700578),
      Sample(0.0001607305111290272),   Sample(-0.00011587335104454923),
      Sample(8.18546720811765e-05),    Sample(-5.651911866613418e-05),
      Sample(3.803058540666502e-05),   Sample(-2.4844836190800587e-05),
      Sample(1.5683140333138368e-05),  Sample(-9.505592281185593e-06),
      Sample(5.483751546198219e-06),   Sample(-2.9728527288939908e-06),
      Sample(1.4841816752156574e-06),  Sample(-6.583595954927711e-07),
      Sample(2.4027590043604873e-07),  Sample(-5.630771290143039e-08),
    },
    {
      Sample(-1.3864222806201323e-07), Sample(4.7275599918950117e-07),
      Sample(-1.1870925682936716e-06), Sample(2.5451571749306487e-06),
      Sample(-4.927690801788528e-06),  Sample(8.863639902663358e-06),
      Sample(-1.5063823215041202e-05), Sample(2.4456399572809425e-05),
      Sample(-3.822314980124776e-05),  Sample(5.783564891638205e-05),
      Sample(-8.509068459329778e-05),  Sample(0.00012214484953600833),
      Sample(-0.00017154919543200032), Sample(0.00023628631905210932),
      Sample(-0.00031981446114117583), Sample(0.0004261264699033928),
      Sample(-0.0005598363880429665),  Sample(0.0007263139947008312),
      Sample(-0.0009318997748348089),  Sample(0.0011842531361041242),
      Sample(-0.0014929224568252222),  Sample(0.0018702916466844365),
      Sample(-0.002333186828673243),   Sample(0.0029056937497020565),
      Sample(-0.0036243291321509117),  Sample(0.004548138553790829),
      Sample(-0.005780116869073672),   Sample(0.007518037348298683),
      Sample(-0.010195642089703772),   Sample(0.014980457762310176),
      Sample(-0.026443677004048028),   Sample(0.0979469803437909),
      Sample(0.05868326463016813),     Sample(-0.022278467980180156),
      Sample(0.013455828730798345),    Sample(-0.00939635593714856),
      Sample(0.007018840551885251),    Sample(-0.0054348317977602634),
      Sample(0.004293385157616765),    Sample(-0.0034282685355974223),
      Sample(0.002750576374384494),    Sample(-0.0022082889384870915),
      Sample(0.0017686851881928633),   Sample(-0.0014098587429739386),
      Sample(0.001116297610744503),    Sample(-0.0008764449571806441),
      Sample(0.000681295138409286),    Sample(-0.0005235612676324346),
      Sample(0.00039717181192713895),  Sample(-0.00029696223044039057),
      Sample(0.00021848407872141108),  Sample(-0.0001578849217727811),
      Sample(0.00011183020395189409),  Sample(-7.744897064139225e-05),
      Sample(5.229210849103534e-05),   Sample(-3.42961955054006e-05),
      Sample(2.1749016275314434e-05),  Sample(-1.3254801079547813e-05),
      Sample(7.698584070761767e-06),   Sample(-4.209927992719584e-06),
      Sample(2.1267535512051394e-06),  Sample(-9.602306856329373e-07),
      Sample(3.6170815155524184e-07),  Sample(-9.253719593264144e-08),
    },
    {
      Sample(-1.2355247744551818e-07), Sample(4.4867391923749034e-07),
      Sample(-1.1570856256420401e-06), Sample(2.520321878971995e-06),
      Sample(-4.932867858183801e-06),  Sample(8.945257397265536e-06),
      Sample(-1.530019839171971e-05),  Sample(2.4970776959234427e-05),
      Sample(-3.919967657336903e-05),  Sample(5.9538392414373163e-05),
      Sample(-8.788569055052775e-05),  Sample(0.0001265251357223486),
      Sample(-0.00017816249123695955), Sample(0.00024596531871256145),
      Sample(-0.00033360938317099695), Sample(0.0004453398390290365),
      Sample(-0.0005860602149525031),  Sample(0.0007614699642211394),
      Sample(-0.0009782837068933873),  Sample(0.0012445858848496992),
      Sample(-0.0015704105290594726),  Sample(0.0019687019063160927),
      Sample(-0.0024569397808246445),  Sample(0.003059975948719535),
      Sample(-0.0038152068506980275),  Sample(0.004782585831839656),
      Sample(-0.006065614192904957),   Sample(0.007860358310848468),
      Sample(-0.010588500205899335),   Sample(0.015349649552777905),
      Sample(-0.02618269703352893),    Sample(0.07946249777856877),
      Sample(0.0794624977785707),      Sample(-0.02618269703353058),
      Sample(0.015349649552779265),    Sample(-0.010588500205900435),
      Sample(0.007860358310849287),    Sample(-0.006065614192905519),
      Sample(0.004782585831840016),    Sample(-0.0038152068506982625),
      Sample(0.003059975948719684),    Sample(-0.002456939780824737),
      Sample(0.0019687019063161586),   Sample(-0.0015704105290595175),
      Sample(0.0012445858848497181),   Sample(-0.0009782837068933897),
      Sample(0.00076146996422113),     Sample(-0.0005860602149524911),
      Sample(0.00044533983902902437),  Sample(-0.0003336093831709861),
      Sample(0.0002459653187125528),   Sample(-0.00017816249123695253),
      Sample(0.00012652513572234398),  Sample(-8.788569055052486e-05),
      Sample(5.9538392414371286e-05),  Sample(-3.919967657336773e-05),
      Sample(2.4970776959233546e-05),  Sample(-1.5300198391719163e-05),
      Sample(8.9452573972652e-06),     Sample(-4.932867858183597e-06),
      Sample(2.5203218789718917e-06),  Sample(-1.1570856256419914e-06),
      Sample(4.486739192374714e-07),   Sample(-1.235524774455132e-07),
    },
    {
      Sample(-9.253719593264516e-08),  Sample(3.61708151555257e-07),
      Sample(-9.602306856329782e-07),  Sample(2.1267535512052266e-06),
      Sample(-4.209927992719758e-06),  Sample(7.698584070762061e-06),
      Sample(-1.3254801079548291e-05), Sample(2.174901627531521e-05),
      Sample(-3.429619550540174e-05),  Sample(5.229210849103699e-05),
      Sample(-7.744897064139474e-05),  Sample(0.0001118302039518981),
      Sample(-0.00015788492177278734), Sample(0.00021848407872141897),
      Sample(-0.00029696223044040033), Sample(0.00039717181192715006),
      Sample(-0.0005235612676324458),  Sample(0.0006812951384092955),
      Sample(-0.0008764449571806438),  Sample(0.0011162976107444874),
      Sample(-0.0014098587429739002),  Sample(0.0017686851881928045),
      Sample(-0.002208288938487011),   Sample(0.002750576374384364),
      Sample(-0.003428268535597217),   Sample(0.0042933851576164505),
      Sample(-0.005434831797759775),   Sample(0.007018840551884529),
      Sample(-0.009396355937147577),   Sample(0.013455828730797119),
      Sample(-0.022278467980178674),   Sample(0.05868326463016637),
      Sample(0.09794698034379272),     Sample(-0.026443677004049586),
      Sample(0.014980457762311458),    Sample(-0.010195642089704814),
      Sample(0.00751803734829947),     Sample(-0.005780116869074218),
      Sample(0.004548138553791179),    Sample(-0.003624329132151141),
      Sample(0.0029056937497022027),   Sample(-0.002333186828673334),
      Sample(0.0018702916466844988),   Sample(-0.0014929224568252673),
      Sample(0.0011842531361041437),   Sample(-0.0009318997748348127),
      Sample(0.000726313994700823),    Sample(-0.0005598363880429556),
      Sample(0.0004261264699033816),   Sample(-0.0003198144611411656),
      Sample(0.00023628631905210106),  Sample(-0.0001715491954319936),
      Sample(0.0001221448495360038),   Sample(-8.509068459329491e-05),
      Sample(5.783564891638023e-05),   Sample(-3.822314980124649e-05),
      Sample(2.4456399572808578e-05),  Sample(-1.5063823215040663e-05),
      Sample(8.863639902663025e-06),   Sample(-4.9276908017883245e-06),
      Sample(2.5451571749305445e-06),  Sample(-1.1870925682936216e-06),
      Sample(4.7275599918948116e-07),  Sample(-1.3864222806200761e-07),
    },
    {
      Sample(-5.630771290143266e-08),  Sample(2.402759004360587e-07),
      Sample(-6.583595954927992e-07),  Sample(1.4841816752157184e-06),
      Sample(-2.9728527288941136e-06), Sample(5.483751546198432e-06),
      Sample(-9.505592281185938e-06),  Sample(1.568314033313893e-05),
      Sample(-2.4844836190801417e-05), Sample(3.8030585406666224e-05),
      Sample(-5.651911866613599e-05),  Sample(8.185467208117943e-05),
      Sample(-0.00011587335104455377), Sample(0.00016073051112903307),
      Sample(-0.00021893194903701297), Sample(0.0002933738565599738),
      Sample(-0.0003873997079535207),  Sample(0.000504887156748793),
      Sample(-0.0006503857644184304),  Sample(0.0008293391455525424),
      Sample(-0.0010484471418521556),  Sample(0.0013162635753481335),
      Sample(-0.0016442014312371266),  Sample(0.0020482716849633048),
      Sample(-0.0025522153604819998),  Sample(0.003193466271687574),
      Sample(-0.004035377644429834),   Sample(0.0051949238194158726),
      Sample(-0.006914734981821023),   Sample(0.00979227063107619),
      Sample(-0.015794621168050752),   Sample(0.03739132540326061),
      Sample(0.11249888367650411),     Sample(-0.022305349892646164),
      Sample(0.012143156763569907),    Sample(-0.008142643464987857),
      Sample(0.005960668445510986),    Sample(-0.004564633936527067),
      Sample(0.0035837917574950344),   Sample(-0.002852537945309299),
      Sample(0.00228584040169707),     Sample(-0.0018354682086415526),
      Sample(0.0014718519921115988),   Sample(-0.0011756361867928465),
      Sample(0.0009333918745799538),   Sample(-0.0007352968550954059),
      Sample(0.0005738191773247128),   Sample(-0.0004429442184900553),
      Sample(0.00033771025677482484),  Sample(-0.00025392519135447996),
      Sample(0.0001879918916897586),   Sample(-0.00013679913173395608),
      Sample(9.765173115755613e-05),   Sample(-6.822341290805183e-05),
      Sample(4.652202055725094e-05),   Sample(-3.0860696837314996e-05),
      Sample(1.983125573093379e-05),   Sample(-1.2277756803317325e-05),
      Sample(7.269484947813123e-06),   Sample(-4.073317099387419e-06),
      Sample(2.1259276878296688e-06),  Sample(-1.0065232339474224e-06),
      Sample(4.108627574241752e-07),   Sample(-1.272635019127051e-07),
    },
    {
      Sample(-2.3617609337536215e-08), Sample(1.1218570885257439e-07),
      Sample(-3.1825436243802967e-07), Sample(7.310695658782384e-07),
      Sample(-1.4825379236356358e-06), Sample(2.7593806147302275e-06),
      Sample(-4.8165622423155086e-06), Sample(7.99165904931897e-06),
      Sample(-1.2719770012619701e-05), Sample(1.9548565602321255e-05),
      Sample(-2.9153136488262292e-05), Sample(4.2350476474777994e-05),
      Sample(-6.011374541559314e-05),  Sample(8.358695544657403e-05),
      Sample(-0.00011410147554131631), Sample(0.00015319686250918788),
      Sample(-0.00020265018158962208), Sample(0.0002645204940138448),
      Sample(-0.00034121913980099476), Sample(0.00043562291697049014),
      Sample(-0.0005512583640555171),  Sample(0.0006926053620364485),
      Sample(-0.0008656062410044057),  Sample(0.0010785428170204314),
      Sample(-0.00134360700573804),    Sample(0.001679867529923361),
      Sample(-0.0021192896052795373),  Sample(0.002720181184158949),
      Sample(-0.0036014665520777414),  Sample(0.005048475706348001),
      Sample(-0.007957208488866278),   Sample(0.01732480501489897),
      Sample(0.12180093197781926),     Sample(-0.01343591904299902),
      Sample(0.006980500436275442),    Sample(-0.0046043096258725595),
      Sample(0.0033439963668829716),   Sample(-0.0025499106324609363),
      Sample(0.0019972279808901225),   Sample(-0.0015876864908529516),
      Sample(0.0012715695620548642),   Sample(-0.0010209857280302952),
      Sample(0.0008189869558993643),   Sample(-0.0006545646869902458),
      Sample(0.000520134167796115),    Sample(-0.00041018267295635615),
      Sample(0.00032050636271930405),  Sample(-0.00024776384347756554),
      Sample(0.00018920855379007612),  Sample(-0.00014252578365347618),
      Sample(0.000105732321526112),    Sample(-7.711391285421861e-05),
      Sample(5.5185374037272056e-05),  Sample(-3.866390316423908e-05),
      Sample(2.6449644680517104e-05),  Sample(-1.7609823541460182e-05),
      Sample(1.136426106385283e-05),   Sample(-7.071094163220972e-06),
      Sample(4.212199706240127e-06),   Sample(-2.3782714519025353e-06),
      Sample(1.253769860681603e-06),   Sample(-6.021079666981665e-07),
      Sample(2.5148249138580234e-07),  Sample(-8.173548204222544e-08),
    },
    {
      Sample(0.0000000000000000),      Sample(1.8461013765352247e-21),
      Sample(-7.982290663598285e-21),  Sample(-2.1484174710137407e-24),
      Sample(-1.2224735931522237e-20), Sample(4.594062884624282e-20),
      Sample(4.617364089293953e-20),   Sample(-9.650121371293738e-21),
      Sample(-9.236627563609614e-20),  Sample(3.088855016336976e-19),
      Sample(-7.11236078844221e-19),   Sample(-1.0374596560668432e-19),
      Sample(-3.6869809486278723e-19), Sample(1.233681000601786e-18),
      Sample(-6.327761698056293e-19),  Sample(-5.679902936062928e-19),
      Sample(-1.0027227581127595e-18), Sample(3.605894551548063e-18),
      Sample(-1.4817332280649315e-18), Sample(-2.16590861613663e-18),
      Sample(-2.056424861745055e-18),  Sample(8.621424353344897e-18),
      Sample(-2.6945197014988877e-18), Sample(3.022347984836886e-18),
      Sample(-3.346242175561026e-18),  Sample(3.658153721446805e-18),
      Sample(-3.949830370501476e-18),  Sample(4.213155453865216e-18),
      Sample(-4.440498715595276e-18),  Sample(4.625058877371579e-18),
      Sample(-4.761177898172258e-18),  Sample(4.844608065874249e-18),
      Sample(0.12500002044374284),     Sample(4.844608065874471e-18),
      Sample(-4.761177898172622e-18),  Sample(4.625058877372033e-18),
      Sample(-4.440498715595746e-18),  Sample(4.213155453865636e-18),
      Sample(-3.949830370501805e-18),  Sample(3.658153721447054e-18),
      Sample(-3.3462421755612093e-18), Sample(3.0223479848370166e-18),
      Sample(-2.6945197014989813e-18), Sample(8.621424353345182e-18),
      Sample(-2.0564248617450996e-18), Sample(-2.1659086161366505e-18),
      Sample(-1.481733228064923e-18),  Sample(3.605894551548004e-18),
      Sample(-1.0027227581127354e-18), Sample(-5.679902936062759e-19),
      Sample(-6.327761698056081e-19),  Sample(1.233681000601739e-18),
      Sample(-3.6869809486277303e-19), Sample(-1.0374596560668065e-19),
      Sample(-7.112360788441984e-19),  Sample(3.088855016336876e-19),
      Sample(-9.236627563609305e-20),  Sample(-9.65012137129339e-21),
      Sample(4.6173640892937835e-20),  Sample(4.5940628846241006e-20),
      Sample(-1.2224735931521732e-20), Sample(-2.1484174710136514e-24),
      Sample(-7.982290663597943e-21),  Sample(1.846101376535149e-21),
    },
  }};
};
