// Copyright (C) 2022  Takamitsu Endo
//
// This program is free software; you can redistribute it and/or
// modify it under the terms of the GNU General Public License
// as published by the Free Software Foundation; either version 2
// of the License, or (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with this program; if not, write to the Free Software
// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.

#pragma once

#include <array>

/**
FIR polyphase lowpass coefficients for 8 fold upsampling.

```python
import numpy as np
import scipy.signal as signal
nTaps = 64
nPhase = 8
fir = signal.firwin(nTaps * nPhase - 1, 24000, window=("dpss", 4), fs=8 * 48000)
fir *= nPhase
fir = np.hstack((fir, [0]))[::1]
poly = fir.reshape((nTaps, nPhase)).T[::-1]
for i, p in enumerate(poly):
    poly[i] = p[::-1]
```
*/
template<typename Sample> struct UpSamplerCoefficient {
  constexpr static size_t bufferSize = 64;
  constexpr static size_t intDelay = 31;
  constexpr static size_t upfold = 8;

  constexpr static std::array<std::array<Sample, bufferSize>, upfold> coefficient{{
    {
      Sample(0.0000000000000000),      Sample(1.4768811012281797e-20),
      Sample(-6.385832530878628e-20),  Sample(-1.7187339768109925e-23),
      Sample(-9.77978874521779e-20),   Sample(3.6752503076994254e-19),
      Sample(3.6938912714351626e-19),  Sample(-7.720097097034991e-20),
      Sample(-7.389302050887692e-19),  Sample(2.471084013069581e-18),
      Sample(-5.689888630753768e-18),  Sample(-8.299677248534745e-19),
      Sample(-2.949584758902298e-18),  Sample(9.869448004814288e-18),
      Sample(-5.062209358445034e-18),  Sample(-4.5439223488503424e-18),
      Sample(-8.021782064902076e-18),  Sample(2.8847156412384506e-17),
      Sample(-1.1853865824519452e-17), Sample(-1.732726892909304e-17),
      Sample(-1.645139889396044e-17),  Sample(6.897139482675918e-17),
      Sample(-2.15561576119911e-17),   Sample(2.4178783878695088e-17),
      Sample(-2.6769937404488207e-17), Sample(2.926522977157444e-17),
      Sample(-3.159864296401181e-17),  Sample(3.3705243630921727e-17),
      Sample(-3.552398972476221e-17),  Sample(3.7000471018972635e-17),
      Sample(-3.808942318537806e-17),  Sample(3.8756864526993995e-17),
      Sample(1.0000001635499427),      Sample(3.875686452699577e-17),
      Sample(-3.808942318538098e-17),  Sample(3.7000471018976265e-17),
      Sample(-3.5523989724765967e-17), Sample(3.3705243630925085e-17),
      Sample(-3.159864296401444e-17),  Sample(2.926522977157643e-17),
      Sample(-2.6769937404489674e-17), Sample(2.4178783878696133e-17),
      Sample(-2.155615761199185e-17),  Sample(6.897139482676146e-17),
      Sample(-1.6451398893960797e-17), Sample(-1.7327268929093204e-17),
      Sample(-1.1853865824519384e-17), Sample(2.884715641238403e-17),
      Sample(-8.021782064901883e-18),  Sample(-4.543922348850207e-18),
      Sample(-5.062209358444865e-18),  Sample(9.869448004813912e-18),
      Sample(-2.9495847589021842e-18), Sample(-8.299677248534452e-19),
      Sample(-5.6898886307535875e-18), Sample(2.471084013069501e-18),
      Sample(-7.389302050887444e-19),  Sample(-7.720097097034712e-20),
      Sample(3.693891271435027e-19),   Sample(3.6752503076992805e-19),
      Sample(-9.779788745217385e-20),  Sample(-1.718733976810921e-23),
      Sample(-6.385832530878354e-20),  Sample(1.4768811012281192e-20),
    },
    {
      Sample(-1.8894087470028972e-07), Sample(8.974856708205951e-07),
      Sample(-2.5460348995042374e-06), Sample(5.848556527025907e-06),
      Sample(-1.1860303389085086e-05), Sample(2.207504491784182e-05),
      Sample(-3.853249793852407e-05),  Sample(6.393327239455177e-05),
      Sample(-0.00010175816010095761), Sample(0.00015638852481857004),
      Sample(-0.00023322509190609834), Sample(0.00033880381179822395),
      Sample(-0.00048090996332474513), Sample(0.0006686956435725922),
      Sample(-0.0009128118043305305),  Sample(0.001225574900073503),
      Sample(-0.0016212014527169766),  Sample(0.002116163952110758),
      Sample(-0.002729753118407958),   Sample(0.003484983335763921),
      Sample(-0.0044100669124441366),  Sample(0.005540842896291588),
      Sample(-0.006924849928035245),   Sample(0.008628342536163451),
      Sample(-0.01074885604590432),    Sample(0.013438940239386889),
      Sample(-0.0169543168422363),     Sample(0.02176144947327159),
      Sample(-0.02881173241662193),    Sample(0.04038780565078401),
      Sample(-0.06365766791093022),    Sample(0.13859844011919176),
      Sample(0.9744074558225541),      Sample(-0.10748735234399216),
      Sample(0.055844003490203534),    Sample(-0.036834477006980476),
      Sample(0.026751970935063773),    Sample(-0.02039928505968749),
      Sample(0.01597782384712098),     Sample(-0.012701491926823613),
      Sample(0.010172556496438914),    Sample(-0.008167885824242362),
      Sample(0.006551895647194914),    Sample(-0.005236517495921966),
      Sample(0.00416107334236892),     Sample(-0.003281461383650849),
      Sample(0.0025640509017544324),   Sample(-0.0019821107478205243),
      Sample(0.001513668430320609),    Sample(-0.0011402062692278095),
      Sample(0.000845858572208896),    Sample(-0.0006169113028337489),
      Sample(0.00044148299229817645),  Sample(-0.00030931122531391265),
      Sample(0.00021159715744413683),  Sample(-0.00014087858833168146),
      Sample(9.091408851082264e-05),   Sample(-5.656875330576778e-05),
      Sample(3.3697597649921014e-05),  Sample(-1.9026171615220282e-05),
      Sample(1.0030158885452825e-05),  Sample(-4.816863733585332e-06),
      Sample(2.0118599310864187e-06),  Sample(-6.538838563378035e-07),
    },
    {
      Sample(-4.5046170321146125e-07), Sample(1.9222072034884695e-06),
      Sample(-5.266876763942394e-06),  Sample(1.1873453401725747e-05),
      Sample(-2.378282183115291e-05),  Sample(4.3870012369587456e-05),
      Sample(-7.604473824948751e-05),  Sample(0.00012546512266511145),
      Sample(-0.00019875868952641133), Sample(0.0003042446832533298),
      Sample(-0.00045215294932908793), Sample(0.0006548373766494354),
      Sample(-0.0009269868083564302),  Sample(0.0012858440890322646),
      Sample(-0.0017514555922961037),  Sample(0.0023469908524797905),
      Sample(-0.0030991976636281656),  Sample(0.004039097253990344),
      Sample(-0.005203086115347443),   Sample(0.006634713164420339),
      Sample(-0.008387577134817244),   Sample(0.010530108602785068),
      Sample(-0.013153611449897013),   Sample(0.016386173479706438),
      Sample(-0.020417722883855998),   Sample(0.025547730173500593),
      Sample(-0.03228302115543867),    Sample(0.04155939055532698),
      Sample(-0.05531787985456819),    Sample(0.07833816504860952),
      Sample(-0.12635696934440602),    Sample(0.29913060322608487),
      Sample(0.8999910694120329),      Sample(-0.1784427991411693),
      Sample(0.09714525410855926),     Sample(-0.06514114771990286),
      Sample(0.04768534756408789),     Sample(-0.03651707149221654),
      Sample(0.028670334059960275),    Sample(-0.022820303562474394),
      Sample(0.01828672321357656),     Sample(-0.014683745669132421),
      Sample(0.01177481593689279),     Sample(-0.009405089494342772),
      Sample(0.0074671349966396305),   Sample(-0.005882374840763247),
      Sample(0.004590553418597702),    Sample(-0.0035435537479204422),
      Sample(0.0027016820541985987),   Sample(-0.0020314015308358396),
      Sample(0.0015039351335180689),   Sample(-0.0010943930538716486),
      Sample(0.0007812138492604491),   Sample(-0.0005457873032644146),
      Sample(0.00037217616445800754),  Sample(-0.00024688557469851997),
      Sample(0.00015865004584747033),  Sample(-9.82220544265386e-05),
      Sample(5.8155879582504984e-05),  Sample(-3.2586536795099354e-05),
      Sample(1.700742150263735e-05),   Sample(-8.052185871579379e-06),
      Sample(3.2869020593934017e-06),  Sample(-1.0181080153016407e-06),
    },
    {
      Sample(-7.402975674611613e-07),  Sample(2.893665212442056e-06),
      Sample(-7.681845485063825e-06),  Sample(1.7014028409641813e-05),
      Sample(-3.367942394175806e-05),  Sample(6.158867256609649e-05),
      Sample(-0.00010603840863638633), Sample(0.00017399213020252168),
      Sample(-0.00027436956404321394), Sample(0.0004183368679282959),
      Sample(-0.0006195917651311579),  Sample(0.0008946416316151848),
      Sample(-0.0012630793741822987),  Sample(0.0017478726297713517),
      Sample(-0.0023756978435232026),  Sample(0.0031773744954172005),
      Sample(-0.004188490141059566),   Sample(0.005450361107274364),
      Sample(-0.00701155965744515),    Sample(0.008930380885955899),
      Sample(-0.011278869943791202),   Sample(0.014149481505542436),
      Sample(-0.017666311507896087),   Sample(0.022004610995074912),
      Sample(-0.027426148284777737),   Sample(0.034347081260931604),
      Sample(-0.0434786543820782),     Sample(0.05615072441507623),
      Sample(-0.07517084749718062),    Sample(0.10764662984637695),
      Sample(-0.1782277438414294),     Sample(0.46946611704133095),
      Sample(0.7835758427503418),      Sample(-0.2115494160323967),
      Sample(0.11984366209849166),     Sample(-0.08156513671763851),
      Sample(0.06014429878639576),     Sample(-0.046240934952593744),
      Sample(0.03638510843032943),     Sample(-0.02899463305720913),
      Sample(0.02324554999761762),     Sample(-0.018665494629386672),
      Sample(0.01496233317347599),     Sample(-0.011943379654602139),
      Sample(0.00947402508883315),     Sample(-0.007455198198678501),
      Sample(0.005810511957606584),    Sample(-0.004478691104343645),
      Sample(0.0034090117592270527),   Sample(-0.0025585156891293247),
      Sample(0.0018902905524168085),   Sample(-0.0013723935634559487),
      Sample(0.0009771587962880304),   Sample(-0.0006807254767463593),
      Sample(0.00046268519133104184),  Sample(-0.0003057851984099719),
      Sample(0.00019565119658246862),  Sample(-0.0001205105857203253),
      Sample(7.09091192213042e-05),    Sample(-3.9421526414306596e-05),
      Sample(2.0361257399444356e-05),  Sample(-9.496740546348973e-06),
      Sample(3.7820479935158493e-06),  Sample(-1.109137824496061e-06),
    },
    {
      Sample(-9.884198195641455e-07), Sample(3.5893913538999227e-06),
      Sample(-9.256685005136321e-06), Sample(2.016257503177596e-05),
      Sample(-3.946294286547041e-05), Sample(7.156205917812429e-05),
      Sample(-0.0001224015871337577), Sample(0.00019976621567387542),
      Sample(-0.0003135974125869522), Sample(0.0004763071393149853),
      Sample(-0.000703085524404222),  Sample(0.0010122010857787887),
      Sample(-0.0014252999298956764), Sample(0.0019677225497004916),
      Sample(-0.0026688750653679756), Sample(0.003562718712232292),
      Sample(-0.004688481719620025),  Sample(0.006091759713769115),
      Sample(-0.007826269655147098),  Sample(0.009956687078797594),
      Sample(-0.012563284232475781),  Sample(0.01574961525052874),
      Sample(-0.019655518246597156),  Sample(0.02447980758975628),
      Sample(-0.03052165480558422),   Sample(0.03826068665471725),
      Sample(-0.04852491354323966),   Sample(0.06288286648678774),
      Sample(-0.08470800164719468),   Sample(0.12279719642222324),
      Sample(-0.20946157626823145),   Sample(0.6356999822285502),
      Sample(0.6356999822285656),     Sample(-0.20946157626824463),
      Sample(0.12279719642223412),    Sample(-0.08470800164720348),
      Sample(0.0628828664867943),     Sample(-0.048524913543244154),
      Sample(0.03826068665472013),    Sample(-0.0305216548055861),
      Sample(0.02447980758975747),    Sample(-0.019655518246597895),
      Sample(0.01574961525052927),    Sample(-0.01256328423247614),
      Sample(0.009956687078797745),   Sample(-0.007826269655147117),
      Sample(0.00609175971376904),    Sample(-0.004688481719619929),
      Sample(0.003562718712232195),   Sample(-0.002668875065367889),
      Sample(0.001967722549700422),   Sample(-0.0014252999298956202),
      Sample(0.0010122010857787518),  Sample(-0.0007030855244041989),
      Sample(0.0004763071393149703),  Sample(-0.00031359741258694187),
      Sample(0.00019976621567386837), Sample(-0.0001224015871337533),
      Sample(7.15620591781216e-05),   Sample(-3.9462942865468775e-05),
      Sample(2.0162575031775134e-05), Sample(-9.256685005135931e-06),
      Sample(3.589391353899771e-06),  Sample(-9.884198195641057e-07),
    },
    {
      Sample(-1.1091378244961058e-06), Sample(3.7820479935160094e-06),
      Sample(-9.496740546349373e-06),  Sample(2.036125739944519e-05),
      Sample(-3.942152641430822e-05),  Sample(7.090911922130687e-05),
      Sample(-0.00012051058572032962), Sample(0.0001956511965824754),
      Sample(-0.00030578519840998206), Sample(0.0004626851913310564),
      Sample(-0.0006807254767463823),  Sample(0.0009771587962880666),
      Sample(-0.0013723935634560025),  Sample(0.0018902905524168746),
      Sample(-0.0025585156891294067),  Sample(0.0034090117592271425),
      Sample(-0.004478691104343732),   Sample(0.005810511957606649),
      Sample(-0.007455198198678471),   Sample(0.009474025088832994),
      Sample(-0.011943379654601778),   Sample(0.014962333173475492),
      Sample(-0.018665494629385944),   Sample(0.023245549997616452),
      Sample(-0.028994633057207293),   Sample(0.036385108430326635),
      Sample(-0.04624093495258937),    Sample(0.060144298786389466),
      Sample(-0.08156513671763017),    Sample(0.11984366209848141),
      Sample(-0.21154941603238422),    Sample(0.7835758427503272),
      Sample(0.46946611704134505),     Sample(-0.17822774384144124),
      Sample(0.10764662984638676),     Sample(-0.07517084749718848),
      Sample(0.05615072441508201),     Sample(-0.04347865438208211),
      Sample(0.03434708126093412),     Sample(-0.027426148284779378),
      Sample(0.022004610995075953),    Sample(-0.017666311507896732),
      Sample(0.014149481505542906),    Sample(-0.011278869943791509),
      Sample(0.008930380885956024),    Sample(-0.007011559657445153),
      Sample(0.005450361107274288),    Sample(-0.004188490141059477),
      Sample(0.0031773744954171116),   Sample(-0.0023756978435231246),
      Sample(0.0017478726297712886),   Sample(-0.0012630793741822488),
      Sample(0.0008946416316151527),   Sample(-0.000619591765131138),
      Sample(0.00041833686792828274),  Sample(-0.0002743695640432048),
      Sample(0.00017399213020251547),  Sample(-0.00010603840863638251),
      Sample(6.158867256609413e-05),   Sample(-3.367942394175667e-05),
      Sample(1.7014028409641115e-05),  Sample(-7.681845485063498e-06),
      Sample(2.8936652124419347e-06),  Sample(-7.402975674611315e-07),
    },
    {
      Sample(-1.0181080153016824e-06), Sample(3.286902059393541e-06),
      Sample(-8.05218587157972e-06),   Sample(1.7007421502638048e-05),
      Sample(-3.258653679510068e-05),  Sample(5.8155879582507166e-05),
      Sample(-9.822205442654211e-05),  Sample(0.00015865004584747575),
      Sample(-0.0002468855746985281),  Sample(0.00037217616445801925),
      Sample(-0.0005457873032644335),  Sample(0.0007812138492604782),
      Sample(-0.001094393053871691),   Sample(0.001503935133518121),
      Sample(-0.0020314015308359034),  Sample(0.002701682054198668),
      Sample(-0.0035435537479205077),  Sample(0.004590553418597746),
      Sample(-0.0058823748407632135),  Sample(0.007467134996639493),
      Sample(-0.009405089494342475),   Sample(0.011774815936892396),
      Sample(-0.014683745669131828),   Sample(0.018286723213575617),
      Sample(-0.02282030356247292),    Sample(0.02867033405995802),
      Sample(-0.03651707149221301),    Sample(0.04768534756408285),
      Sample(-0.06514114771989625),    Sample(0.0971452541085512),
      Sample(-0.17844279914115954),    Sample(0.8999910694120217),
      Sample(0.2991306032260956),      Sample(-0.12635696934441484),
      Sample(0.07833816504861685),     Sample(-0.05531787985457401),
      Sample(0.04155939055533122),     Sample(-0.0322830211554415),
      Sample(0.025547730173502415),    Sample(-0.020417722883857185),
      Sample(0.01638617347970719),     Sample(-0.013153611449897483),
      Sample(0.010530108602785422),    Sample(-0.008387577134817461),
      Sample(0.006634713164420421),    Sample(-0.005203086115347434),
      Sample(0.004039097253990283),    Sample(-0.003099197663628097),
      Sample(0.0023469908524797233),   Sample(-0.0017514555922960463),
      Sample(0.0012858440890322175),   Sample(-0.0009269868083563938),
      Sample(0.000654837376649412),    Sample(-0.00045215294932907346),
      Sample(0.00030424468325332014),  Sample(-0.0001987586895264047),
      Sample(0.00012546512266510695),  Sample(-7.604473824948474e-05),
      Sample(4.3870012369585755e-05),  Sample(-2.3782821831151926e-05),
      Sample(1.1873453401725259e-05),  Sample(-5.266876763942169e-06),
      Sample(1.92220720348839e-06),    Sample(-4.504617032114431e-07),
    },
    {
      Sample(-6.538838563378301e-07),  Sample(2.011859931086504e-06),
      Sample(-4.816863733585534e-06),  Sample(1.003015888545324e-05),
      Sample(-1.9026171615221048e-05), Sample(3.369759764992226e-05),
      Sample(-5.656875330576981e-05),  Sample(9.091408851082571e-05),
      Sample(-0.00014087858833168606), Sample(0.00021159715744414347),
      Sample(-0.0003093112253139235),  Sample(0.0004414829922981931),
      Sample(-0.0006169113028337726),  Sample(0.0008458585722089246),
      Sample(-0.0011402062692278444),  Sample(0.0015136684303206464),
      Sample(-0.0019821107478205586),  Sample(0.002564050901754451),
      Sample(-0.0032814613836508236),  Sample(0.004161073342368837),
      Sample(-0.005236517495921795),   Sample(0.006551895647194691),
      Sample(-0.00816788582424202),    Sample(0.010172556496438374),
      Sample(-0.012701491926822774),   Sample(0.01597782384711969),
      Sample(-0.020399285059685492),   Sample(0.02675197093506095),
      Sample(-0.03683447700697679),    Sample(0.055844003490199086),
      Sample(-0.10748735234398675),    Sample(0.974407455822548),
      Sample(0.1385984401191974),      Sample(-0.06365766791093487),
      Sample(0.04038780565078787),     Sample(-0.028811732416624984),
      Sample(0.02176144947327379),     Sample(-0.01695431684223775),
      Sample(0.013438940239387827),    Sample(-0.010748856045904929),
      Sample(0.008628342536163836),    Sample(-0.006924849928035489),
      Sample(0.005540842896291774),    Sample(-0.0044100669124442415),
      Sample(0.0034849833357639593),   Sample(-0.0027297531184079476),
      Sample(0.0021161639521107244),   Sample(-0.0016212014527169395),
      Sample(0.001225574900073467),    Sample(-0.0009128118043305),
      Sample(0.0006686956435725673),   Sample(-0.0004809099633247264),
      Sample(0.0003388038117982119),   Sample(-0.00023322509190609096),
      Sample(0.00015638852481856502),  Sample(-0.0001017581601009542),
      Sample(6.393327239454945e-05),   Sample(-3.853249793852266e-05),
      Sample(2.207504491784096e-05),   Sample(-1.1860303389084598e-05),
      Sample(5.848556527025665e-06),   Sample(-2.546034899504128e-06),
      Sample(8.974856708205585e-07),   Sample(-1.8894087470028207e-07),
    },
  }};
};
